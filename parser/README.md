# `parser/`  
Документация к утилите парсинга логов телеграмм бота Дейзи 

---

## Предупреждение
В соответствии с договорными условиями полная версия заказа доступна лишь внутри компании и публично не выкладывается

## Состав директории

| Файл | Назначение |
|------|------------|
| **`parser.py`**   | Скрипт с единственной функцией `parsing()` — читает текстовый файл и превращает его в список словарей. |
| **`messages.txt`**| Пример входных данных — фрагмент логов с карточками задач. |

---

## Что делает скрипт

Функция `parsing()` ищет в файле строки, содержащие слово **«Проект»**. Каждая такая строка считается началом нового блока; блок заканчивается пустой строкой.  
Внутри блока каждая строка разбивается **по первому двоеточию**: левая часть становится ключом словаря, правая — значением. Готовый словарь добавляется в результирующий список. Это позволяет быстро извлечь карточки задач из длинного текстового лога.:contentReference[oaicite:0]{index=0}

> **Замечание:** по умолчанию обрабатываются только первые 100 строк; легко расширяется для полного разбора.

---

## Быстрый старт

```bash
git clone https://github.com/ValeriaBelyaeva/freelance.git
cd freelance/parser

# (опционально) создать виртуальное окружение
python -m venv venv
source venv/bin/activate   # Windows: venv\Scripts\activate

python
>>> from parser import parsing
>>> logs = parsing("messages.txt", codec="utf-8")
>>> logs[0]   # пример первой записи
````

Пример одной записи из `messages.txt`:

```python
{
    'Проект': 'MGS',
    'Ассет': 'astropat_capsule',
    'Этап': 'prototype',
    'Исполнитель': 'batukhtin',
    'Дата': '02.10.2020 0:50:27',
    'Jira link': 'OUT-13959',
    'Hours': '40',
    'in_work link': r'U:\Magnus\outsource\02_in_work\ch_astropat_capsule_prttp_(batukhtin)\10_02(TZ_source)',
    'outsource FTP link': r'U:\FTP\outsource\batukhtin\from_saber\2020\10_02\MGS\astropat_capsule_prttp_(TZ_source)'
}
```

---

## Параметры функции

| Параметр    | Тип   | По умолчанию     | Описание                       |
| ----------- | ----- | ---------------- | ------------------------------ |
| `file_name` | `str` | `"messages.txt"` | Имя или путь к входному файлу. |
| `codec`     | `str` | `"utf-8"`        | Кодировка файла.               |

**Возвращает:** `list[dict]` — список словарей с расколотыми по ключам данными.

---

## Архитектура функции

```
flowchart TD
  A[Открыть файл] --> B{Читаем строку}
  B -->|содержит «Проект»| C[Начать новый блок]
  C --> D[parse_flag = 1]
  B -->|пустая строка и parse_flag=1| E[Закрыть блок и append(current_log)]
  B -->|parse_flag = 1| F[Разбить «key: value» → current_log[key]=value]
  E --> D
  F --> B
```

---

## Примечания и ограничения

1. **Все значения строки.** Даты и числа остаются в виде строк, преобразуйте их после парсинга при необходимости.
2. **Точное совпадение «Проект».** Если нужно искать в разных регистрах или на другом языке, скорректируйте условие проверки.
3. **Полная версия проекта.** Содержит готовый UI-модуль и расширенные инструменты распознавания событий. В соответствии с договорными
условиями эти наработки доступны лишь внутри компании и публично не выкладываются.
---

*Автор: Валерия Беляева, 2025 г.*
